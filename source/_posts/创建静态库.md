---
title: 创建静态库
comments: true
date: 2018-04-16 22:26:46
tags:
	- .a
	- .frmamework
categories:
	- iOS
photos:
thumbnail:
---

创建静态库的方式有两种，分别为.a跟.framework。

<!-- more -->

## 创建.framework

### 新建Xcode项目选择 Cocoa Touch Framework

![Cocoa Touch Framework](/gallery/静态库-001.png)

### 新建一个测试类

```objc
// Test.h
@interface Test : NSObject
/**
  输出字符串
 */
+ (void)string;
@end

// Test.m
#import "Test.h"

@implementation Test
/**
 输出字符串
 */
+ (void)string{
    NSLog(@"framework test");
}
@end
```
### 配置headers-在Build Phases -> Headers下将Project下的你要提供给外部调用的头文件拖到Public下

![Build Phases](/gallery/静态库-002.png)

### 在target-> build setting - > link下修改基本配置

![Build Setting](/gallery/静态库-003.png)

> 1、首先是Dead Code Stripping设置为NO，网上对此项的解释如下，大致意思是如果开启此项就会对代码中的”dead”、”unreachable”的代码过滤，不过这个开关是否关闭，似乎没有多大影响，不过为了完整还原framework中的代码，将此项关闭也未曾不可。
2、然后将Link With Standard Libraries关闭，我想可能是为了避免重复链接
3、最后将Mach-O Type设为Static Library，framework可以是动态库也可以是静态库，对于系统的framework是动态库，而用户制作的framework只能是静态库。

### 将静态库导入项目中确保已经导入

![Build Setting](/gallery/静态库-004.png)

```objc
/// 导入头文件
#import <FrameworkTest/FrameworkTest.h>
@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [Test string];
}

```

## 创建.a 

### 新建Xcode项目选择 Cocoa Touch Static Library

![Cocoa Touch Static Library Framework](/gallery/静态库-005.png)

### 新建一个测试类

```objc
// Test.h
@interface Test : NSObject
/**
  输出字符串
 */
+ (void)string;
@end

// Test.m
#import "Test.h"

@implementation Test
/**
 输出字符串
 */
+ (void)string{
    NSLog(@"Cocoa Touch Static Library test");
}
@end
```
### 配置headers-在Build Phases -> Copy Files下将你要提供给外部调用的头文件添加进来


![Build Phases](/gallery/静态库-008.png)

### 在target-> build setting - > link下将Build Active Architecture Only设置为NO

![Build Active Architecture Only](/gallery/静态库-006.png)

> 	Build Active Architecture Only选项设置  Build Setting里面的Build Active Architecture Only设置为NO。Build Active Architecture Only设置为YES时，是为了debug的时候编译速度更快，此时它只编译当前的architecture版本。设置为NO时，会编译所有的版本。

### 切换scame在run 时为release，然后CMD+B编译项目

![run](/gallery/静态库-007.png)

### 编译以后会在Xcode左侧Products文件夹下会生成.a文件，之后show in find，将.a文件佶include下的.h文件一起倒入项目

![.a](/gallery/静态库-009.png)

![.a](/gallery/静态库-010.png)

### 将静态库导入项目中确保已经导入

![Build Setting](/gallery/静态库-011.png)

```objc
/// 导入头文件
#import "Test.h"
@interface ViewController ()

@end

@implementation ViewController

- (void)viewDidLoad {
    [super viewDidLoad];
    // Do any additional setup after loading the view, typically from a nib.
    [Test string];
}

```

